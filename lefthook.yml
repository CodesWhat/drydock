---
pre-commit:
  commands:
    format:
      glob: '*.{ts,js,json,vue,css}'
      run: qlty fmt --no-progress {staged_files} && git add {staged_files}

pre-push:
  piped: false
  commands:
    zizmor:
      glob: '.github/workflows/*.yml'
      run: zizmor .github/workflows/
      skip:
        - run: '! command -v zizmor >/dev/null 2>&1'
    qlty:
      run: CI=1 qlty check --no-progress --skip-source-fetch --no-upgrade-check --summary
    snyk-deps:
      root: app/
      run: ../scripts/snyk-deps-gate.sh --org=codeswhat
    snyk-code:
      run: scripts/snyk-code-gate.sh --org=codeswhat
    build:
      root: app/
      run: npm run build
    test:
      root: app/
      run: npm test
    ui-build:
      root: ui/
      run: npm run build
    ui-test:
      root: ui/
      run: npm run test:unit
    e2e:
      run: ./scripts/run-e2e-tests.sh
